<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>MaliApp</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Arial;
  background:linear-gradient(135deg,#141e30,#243b55);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  color:#fff;
}
.box{
  background:#1f2a40;
  padding:20px;
  width:360px;
  border-radius:15px;
  box-shadow:0 20px 40px rgba(0,0,0,.4);
}
h2,h3{text-align:center;}
input,button{
  width:100%;
  padding:10px;
  margin:6px 0;
  border-radius:8px;
  border:none;
}
input{outline:none;}
button{
  background:#00c853;
  color:#000;
  font-weight:bold;
  cursor:pointer;
}
button:disabled{
  background:#555;
  color:#ccc;
}
.task{
  background:#2e3c5d;
  padding:10px;
  margin:8px 0;
  border-radius:10px;
}
.task.done{
  background:#1b5e20;
}
.timer{
  font-size:14px;
  margin-top:5px;
}
</style>
</head>

<body>

<!-- ØªØ³Ø¬ÙŠÙ„ / Ø¯Ø®ÙˆÙ„ -->
<div class="box" id="auth">
  <h2>MaliApp</h2>
  <input id="email" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
  <input id="password" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button onclick="register()">ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨</button>
  <button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
<div class="box" id="app" style="display:none">
  <h2>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ğŸ‘‹</h2>
  <p>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <b>1</b></p>
  <p>Ø§Ù„Ø±ØµÙŠØ¯: <b><span id="balance">0</span> Ù…Ø§Ù„ÙŠ</b></p>

  <h3>Ø§Ù„Ù…Ù‡Ø§Ù… (Ù…Ø³ØªÙˆÙ‰ 1)</h3>
  <div id="tasks"></div>
</div>

<script>
let balance = Number(localStorage.getItem("balance")) || 0;
let user = localStorage.getItem("user");
let activeTask = null;

const TASK_TIME = 30; // Ø«Ø§Ù†ÙŠØ©
const COOLDOWN = 24 * 60 * 60 * 1000; // 24 Ø³Ø§Ø¹Ø©

const tasks = [
  {id:1,title:"Ù…Ø´Ø§Ù‡Ø¯Ø© Ø¥Ø¹Ù„Ø§Ù†"},
  {id:2,title:"ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"},
  {id:3,title:"Ø²ÙŠØ§Ø±Ø© ØµÙØ­Ø©"},
  {id:4,title:"ØªØ¬Ø±Ø¨Ø© Ù…ÙŠØ²Ø©"},
  {id:5,title:"Ù…Ø´Ø§Ø±ÙƒØ© Ø±Ø§Ø¨Ø·"}
];

if(user){
  showApp();
}

function register(){
  const email = email.value;
  const pass = password.value;
  if(!email || !pass){ alert("Ø¹Ù…Ù‘Ø± Ø§Ù„Ù…Ø¹Ø·ÙŠØ§Øª"); return; }
  localStorage.setItem("user", email);
  alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ âœ…");
  showApp();
}

function login(){
  const email = email.value;
  const pass = password.value;
  if(localStorage.getItem("user") === email){
    showApp();
  }else{
    alert("Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
  }
}

function showApp(){
  document.getElementById("auth").style.display="none";
  document.getElementById("app").style.display="block";
  document.getElementById("balance").innerText = balance;
  renderTasks();
}

function renderTasks(){
  const box = document.getElementById("tasks");
  box.innerHTML = "";
  tasks.forEach(t=>{
    const lastDone = localStorage.getItem("task_"+t.id);
    const now = Date.now();
    let canDo = !lastDone || now - lastDone > COOLDOWN;

    const div = document.createElement("div");
    div.className = "task";
    if(!canDo) div.classList.add("done");

    const btn = document.createElement("button");
    btn.innerText = canDo ? "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ù‡Ù…Ø©" : "ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø©";
    btn.disabled = !canDo || activeTask;

    btn.onclick = ()=>startTask(t.id,btn,div);

    div.innerHTML = `<b>${t.title}</b>`;
    div.appendChild(btn);
    box.appendChild(div);
  });
}

function startTask(id,btn,div){
  if(activeTask){
    alert("Ù‡Ù†Ø§Ùƒ Ù…Ù‡Ù…Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„");
    return;
  }
  activeTask = id;
  let time = TASK_TIME;

  btn.disabled = true;
  const timer = document.createElement("div");
  timer.className="timer";
  div.appendChild(timer);

  const interval = setInterval(()=>{
    timer.innerText = `â³ ${time} Ø«Ø§Ù†ÙŠØ©`;
    time--;
    if(time < 0){
      clearInterval(interval);
      completeTask(id,div);
    }
  },1000);
}

function completeTask(id,div){
  activeTask = null;
  balance += 10;
  localStorage.setItem("balance",balance);
  localStorage.setItem("task_"+id,Date.now());
  document.getElementById("balance").innerText = balance;
  div.classList.add("done");
  renderTasks();
}
</script>

</body>
</html>
