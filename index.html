<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>MaliApp</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --main:#5b2dff;
  --bg:#f4f6ff;
  --card:#ffffff;
  --text:#222;
}
*{box-sizing:border-box;font-family:Arial}
body{
  margin:0;
  background:var(--bg);
}
.screen{
  display:none;
  min-height:100vh;
  padding:20px;
}
.active{display:block}
.card{
  background:var(--card);
  border-radius:14px;
  padding:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.1);
}
input,button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  background:var(--main);
  color:#fff;
  border:none;
  font-size:16px;
}
button:disabled{background:#aaa}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.settings-btn{
  font-size:22px;
  cursor:pointer;
}
.task{
  border:1px solid #ddd;
  padding:12px;
  border-radius:10px;
  margin:10px 0;
}
.task.done{opacity:.5}
.bottom-nav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#fff;
  display:flex;
  justify-content:space-around;
  padding:10px;
  border-top:1px solid #ddd;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="screen active" id="login">
  <div class="card">
    <h2>ğŸš€ MaliApp</h2>
    <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    <input id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
    <input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <input id="pass2" type="password" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <input id="invite" placeholder="Ø±Ù…Ø² Ø§Ù„Ø¯Ø¹ÙˆØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
    <button onclick="register()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
    <button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
  </div>
</div>

<!-- HOME -->
<div class="screen" id="home">
  <div class="header">
    <h3>ğŸ  MaliApp</h3>
    <span class="settings-btn" onclick="openSettings()">âš™ï¸</span>
  </div>

  <div class="card">
    <p>ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯: <b id="balance">0</b> Ù…Ø§Ù„ÙŠ</p>
    <p>â­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <b id="level">1</b></p>
    <p>ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ©:</p>
    <small id="ref"></small>
  </div>

  <h3>ğŸ“‹ Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1</h3>
  <div id="tasks"></div>
</div>

<!-- SETTINGS -->
<div class="screen" id="settings">
  <div class="card">
    <h3>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
    <button onclick="changeLang()">ğŸŒ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©</button>
    <button onclick="alert('Ø³ÙŠØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§')">ğŸ‘› Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø©</button>
    <button onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>
</div>

<script>
let user = JSON.parse(localStorage.getItem("user"));
let activeTask = localStorage.getItem("activeTask");
let tasksData = [
  {id:1,name:"Ù…Ù‡Ù…Ø© 1",reward:5},
  {id:2,name:"Ù…Ù‡Ù…Ø© 2",reward:5},
  {id:3,name:"Ù…Ù‡Ù…Ø© 3",reward:5},
  {id:4,name:"Ù…Ù‡Ù…Ø© 4",reward:5},
  {id:5,name:"Ù…Ù‡Ù…Ø© 5",reward:5},
];

if(user){showHome();}

function register(){
  let email = emailInput();
  if(!email || pass.value.length<6 || pass.value!==pass2.value){
    alert("ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    return;
  }
  let refCode = "MALI"+Math.floor(Math.random()*100000);
  user={
    email,
    balance:0,
    level:1,
    ref:refCode,
    tasks:{}
  };
  localStorage.setItem("user",JSON.stringify(user));
  showHome();
}

function login(){
  if(user) showHome();
  else alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ØŒ Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ù‹Ø§");
}

function showHome(){
  switchScreen("home");
  balance.innerText=user.balance;
  level.innerText=user.level;
  ref.innerText=location.href+"?ref="+user.ref;
  renderTasks();
}

function renderTasks(){
  tasks.innerHTML="";
  tasksData.forEach(t=>{
    let last = user.tasks[t.id];
    let done = last && Date.now()-last < 86400000;
    let div=document.createElement("div");
    div.className="task"+(done?" done":"");
    div.innerHTML=`
      <b>${t.name}</b><br>
      Ø±Ø¨Ø­: ${t.reward} Ù…Ø§Ù„ÙŠ<br>
      <button ${done?"disabled":""} onclick="startTask(${t.id},${t.reward})">
        ${done?"ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø©":"Ø§Ø¨Ø¯Ø£"}
      </button>
    `;
    tasks.appendChild(div);
  });
}

function startTask(id,reward){
  if(activeTask){alert("Ù‡Ù†Ø§Ùƒ Ù…Ù‡Ù…Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„");return;}
  activeTask=id;
  localStorage.setItem("activeTask",id);
  setTimeout(()=>{
    user.balance+=reward;
    user.tasks[id]=Date.now();
    if(user.balance>=25) user.level=2;
    localStorage.setItem("user",JSON.stringify(user));
    localStorage.removeItem("activeTask");
    activeTask=null;
    alert("âœ… ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø©");
    showHome();
  },30000);
}

function openSettings(){switchScreen("settings")}
function logout(){
  localStorage.removeItem("user");
  location.reload();
}
function switchScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}
function emailInput(){return document.getElementById("email").value}
function changeLang(){alert("Ø§Ù„Ù„ØºØ© Ø³ØªØ¶Ø§Ù Ù‚Ø±ÙŠØ¨Ù‹Ø§")}
</script>

</body>
</html>
